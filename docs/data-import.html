<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
  <meta charset="utf-8">
  <meta name="generator" content="quarto-0.3.32">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <meta name="description" content="介绍实用相关工具对 LI-6800 和 LI-6400 光合数据进行分析的一些方法，主要以 R 为主， 有时候为方便或者作为比较，会涉及 python 和其他工具。">
  <title>LI-6800 和 LI-6400 光合数据分析指南 - 5&nbsp; 数据读取的选项</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>

  <script src="site_libs/quarto-nav/quarto-nav.js"></script>
  <script src="site_libs/quarto-nav/headroom.min.js"></script>
  <script src="site_libs/clipboard/clipboard.min.js"></script>
  <meta name="quarto:offset" content="./">
  <script src="site_libs/quarto-search/autocomplete.umd.js"></script>
  <script src="site_libs/quarto-search/fuse.min.js"></script>
  <script src="site_libs/quarto-search/quarto-search.js"></script>
  <link href="./batch-method.html" rel="next">
  <link href="./data-prepare.html" rel="prev">
  <script src="site_libs/quarto-html/quarto.js"></script>
  <script src="site_libs/quarto-html/popper.min.js"></script>
  <script src="site_libs/quarto-html/tippy.umd.min.js"></script>
  <script src="site_libs/quarto-html/anchor.min.js"></script>
  <link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
  <link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet">
  <script src="site_libs/bootstrap/bootstrap.min.js"></script>
  <link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
  <link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
  <script id="quarto-search-options" type="application/json">{
    "location": "sidebar",
    "copy-button": false,
    "collapse-after": 2,
    "panel-placement": "start",
    "type": "textbox",
    "limit": 20,
    "language": {
      "search-no-results-text": "No results",
      "search-matching-documents-text": "matching documents",
      "search-copy-link-title": "Copy link to search",
      "search-hide-matches-text": "Hide additional matches",
      "search-more-match-text": "more match in this document",
      "search-more-matches-text": "more matches in this document",
      "search-clear-button-title": "Clear",
      "search-detached-cancel-button-title": "Cancel",
      "search-submit-button-title": "Submit"
    }
  }</script>
  <script src="site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
  <link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
  <script src="site_libs/datatables-binding-0.20/datatables.js"></script>
  <script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <link href="site_libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet">
  <link href="site_libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet">
  <script src="site_libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
  <link href="site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
  <script src="site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body class="floating">
<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">数据读取的选项</span></h1>
      <button type="button" class="quarto-btn-toggle btn">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
  <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">LI-6800 和 LI-6400 光合数据分析指南</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/zhujiedong/photosynthesis-analysis/" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
</div>
    </div>
  </div>
    <div class="mt-2 flex-shrink-0 align-items-center">
      <div class="sidebar-search">
      <div id="quarto-search" class="" title="Search"></div>
      </div>
    </div>
  <div class="sidebar-menu-container"> 
  <ul class="list-unstyled mt-1">
      <li class="sidebar-item">
  <a href="./index.html" class="">欢迎</a>
</li>
      <li class="sidebar-item">
  <a href="./thanks.html" class="">致谢</a>
</li>
      <li class="sidebar-item">
  <a href="./preface.html" class="">序言</a>
</li>
      <li class="sidebar-item">
  <a href="./intro.html" class="">介绍</a>
</li>
      <ul class="list-unstyled sidebar-section depth1">
    <li class="">
        <div class="me-auto">
          <div class="d-inline-flex w-100 sidebar-section-item">
            <div class="sidebar-section-link me-auto">
            <a href="./basics.html" class="">必备工具</a>
            </div>
            <a class="text-start  " data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-basics.qmd" aria-expanded="true">
              <div><i class="bi bi-chevron-right ms-2"></i></div>
            </a>
            </div>
        </div>
      <div class="collapse  show" id="quarto-sidebar-section-basics.qmd">
        <ul class="list-unstyled sidebar-item-contents">
          <li class="sidebar-item">
  <a href="./rbasics.html" class=""><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">R 相关的准备</span></a>
</li>
          <li class="sidebar-item">
  <a href="./python-basics.html" class=""><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">其他工具</span></a>
</li>
        </ul>
      </div>
    </li>
  </ul>
      <ul class="list-unstyled sidebar-section depth1">
    <li class="">
        <div class="me-auto">
          <div class="d-inline-flex w-100 sidebar-section-item">
            <div class="sidebar-section-link me-auto">
            <a href="./packages.html" class="">光合相关的软件包</a>
            </div>
            <a class="text-start  " data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-packages.qmd" aria-expanded="true">
              <div><i class="bi bi-chevron-right ms-2"></i></div>
            </a>
            </div>
        </div>
      <div class="collapse  show" id="quarto-sidebar-section-packages.qmd">
        <ul class="list-unstyled sidebar-item-contents">
          <li class="sidebar-item">
  <a href="./phtosyn-pacakges.html" class=""><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">光合专用软件包</span></a>
</li>
          <li class="sidebar-item">
  <a href="./general-packages.html" class=""><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">生态学通用软件包</span></a>
</li>
        </ul>
      </div>
    </li>
  </ul>
      <ul class="list-unstyled sidebar-section depth1">
    <li class="">
        <div class="me-auto">
          <div class="d-inline-flex w-100 sidebar-section-item">
            <div class="sidebar-section-link me-auto">
            <a href="./data-prepare.html" class="">数据准备</a>
            </div>
            <a class="text-start  " data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-data-prepare.qmd" aria-expanded="true">
              <div><i class="bi bi-chevron-right ms-2"></i></div>
            </a>
            </div>
        </div>
      <div class="collapse  show" id="quarto-sidebar-section-data-prepare.qmd">
        <ul class="list-unstyled sidebar-item-contents">
          <li class="sidebar-item">
  <a href="./data-import.html" class="active"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">数据读取的选项</span></a>
</li>
          <li class="sidebar-item">
  <a href="./batch-method.html" class=""><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">数据的基本处理</span></a>
</li>
        </ul>
      </div>
    </li>
  </ul>
      <ul class="list-unstyled sidebar-section depth1">
    <li class="">
        <div class="me-auto">
          <div class="d-inline-flex w-100 sidebar-section-item">
            <div class="sidebar-section-link me-auto">
            <a href="./light-response.html" class="">光响应曲线简介</a>
            </div>
            <a class="text-start  " data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-light-response.qmd" aria-expanded="true">
              <div><i class="bi bi-chevron-right ms-2"></i></div>
            </a>
            </div>
        </div>
      <div class="collapse  show" id="quarto-sidebar-section-light-response.qmd">
        <ul class="list-unstyled sidebar-item-contents">
          <li class="sidebar-item">
  <a href="./nls-start.html" class=""><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">非线性拟合初值确定</span></a>
</li>
          <li class="sidebar-item">
  <a href="./hyp.html" class=""><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">直角双曲线模型</span></a>
</li>
          <li class="sidebar-item">
  <a href="./non-hypo.html" class=""><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">非直角双曲线模型</span></a>
</li>
          <li class="sidebar-item">
  <a href="./exp.html" class=""><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">指数模型</span></a>
</li>
          <li class="sidebar-item">
  <a href="./hyp-rev.html" class=""><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">直角双曲线的修正模型</span></a>
</li>
          <li class="sidebar-item">
  <a href="./aq-choose.html" class=""><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">如何选择合适的模型</span></a>
</li>
          <li class="sidebar-item">
  <a href="./big-leaf.html" class=""><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">大叶模型</span></a>
</li>
        </ul>
      </div>
    </li>
  </ul>
      <ul class="list-unstyled sidebar-section depth1">
    <li class="">
        <div class="me-auto">
          <div class="d-inline-flex w-100 sidebar-section-item">
            <div class="sidebar-section-link me-auto">
            <a href="./aci-curve.html" class="">二氧化碳响应曲线概述</a>
            </div>
            <a class="text-start  " data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-aci-curve.qmd" aria-expanded="true">
              <div><i class="bi bi-chevron-right ms-2"></i></div>
            </a>
            </div>
        </div>
      <div class="collapse  show" id="quarto-sidebar-section-aci-curve.qmd">
        <ul class="list-unstyled sidebar-item-contents">
          <li class="sidebar-item">
  <a href="./aci.html" class=""><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Aci 曲线拟合相关</span></a>
</li>
          <li class="sidebar-item">
  <a href="./DAT-vs-racir.html" class=""><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">快速<code>ACi</code> 曲线 (RACiR)</span></a>
</li>
          <li class="sidebar-item">
  <a href="./plantecowraps.html" class=""><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">plantecowrap 温度相关拟合</span></a>
</li>
          <li class="sidebar-item">
  <a href="./Rd.html" class=""><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Rd 呼吸 相关</span></a>
</li>
          <li class="sidebar-item">
  <a href="./C4-related.html" class=""><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">C4 植物光合模拟</span></a>
</li>
        </ul>
      </div>
    </li>
  </ul>
      <ul class="list-unstyled sidebar-section depth1">
    <li class="">
        <div class="me-auto">
          <div class="d-inline-flex w-100 sidebar-section-item">
            <div class="sidebar-section-link me-auto">
            <a href="./fluorescence.html" class="">叶绿素荧光数据的处理</a>
            </div>
            <a class="text-start  " data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-fluorescence.qmd" aria-expanded="true">
              <div><i class="bi bi-chevron-right ms-2"></i></div>
            </a>
            </div>
        </div>
      <div class="collapse  show" id="quarto-sidebar-section-fluorescence.qmd">
        <ul class="list-unstyled sidebar-item-contents">
          <li class="sidebar-item">
  <a href="./jiptest.html" class=""><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">LI-6800 JIP test 分析</span></a>
</li>
          <li class="sidebar-item">
  <a href="./other-fluor.html" class=""><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">其他叶绿素荧光数据处理</span></a>
</li>
        </ul>
      </div>
    </li>
  </ul>
      <ul class="list-unstyled sidebar-section depth1">
    <li class="">
        <div class="me-auto">
          <div class="d-inline-flex w-100 sidebar-section-item">
            <div class="sidebar-section-link me-auto">
            <a href="./gm-gs.html" class="">叶肉与气孔导度</a>
            </div>
            <a class="text-start  " data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-gm-gs.qmd" aria-expanded="true">
              <div><i class="bi bi-chevron-right ms-2"></i></div>
            </a>
            </div>
        </div>
      <div class="collapse  show" id="quarto-sidebar-section-gm-gs.qmd">
        <ul class="list-unstyled sidebar-item-contents">
          <li class="sidebar-item">
  <a href="./gs.html" class=""><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">气孔导度模型的拟合</span></a>
</li>
          <li class="sidebar-item">
  <a href="./gm.html" class=""><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">叶肉导度计算</span></a>
</li>
        </ul>
      </div>
    </li>
  </ul>
      <ul class="list-unstyled sidebar-section depth1">
    <li class="">
        <div class="me-auto">
          <div class="d-inline-flex w-100 sidebar-section-item">
            <div class="sidebar-section-link me-auto">
            <a href="./other-stat.html" class="">其他统计方法</a>
            </div>
            <a class="text-start  " data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-other-stat.qmd" aria-expanded="true">
              <div><i class="bi bi-chevron-right ms-2"></i></div>
            </a>
            </div>
        </div>
      <div class="collapse  show" id="quarto-sidebar-section-other-stat.qmd">
        <ul class="list-unstyled sidebar-item-contents">
          <li class="sidebar-item">
  <a href="./common-stat.html" class=""><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">常用统计方法简介</span></a>
</li>
          <li class="sidebar-item">
  <a href="./pca.html" class=""><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">大话 PCA</span></a>
</li>
          <li class="sidebar-item">
  <a href="./smatr.html" class=""><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">标准主轴分析介绍</span></a>
</li>
        </ul>
      </div>
    </li>
  </ul>
      <li class="sidebar-item">
  <a href="./references.html" class=""><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">参考文献</span></a>
</li>
      <ul class="list-unstyled sidebar-section depth1">
    <li class="">
        <div class="me-auto">
            <a class="sidebar-section-item d-inline-flex text-start w-100 " data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-appendices" aria-expanded="true">
              <div class="me-auto sidebar-section-item">Appendices</div>
            <div><i class="bi bi-chevron-right ms-2"></i></div>
            </a>
        </div>
      <div class="collapse  show" id="quarto-sidebar-section-appendices">
        <ul class="list-unstyled sidebar-item-contents">
          <li class="sidebar-item">
  <a href="./a1-run-environment.html" class=""><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">运行环境</span></a>
</li>
        </ul>
      </div>
    </li>
  </ul>
  </ul>
  </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
      <nav id="TOC" role="doc-toc">
<h2 id="toc-title">Table of contents</h2>
<ul>
<li><a href="#sec-6400-excel" class="nav-link active" data-scroll-target="#sec-6400-excel"> <span class="header-section-number">5.1</span> LI-6400 Excel 的处理</a>
<ul class="collapse">
<li><a href="#sec-install_readphoto" class="nav-link" data-scroll-target="#sec-install_readphoto"> <span class="header-section-number">5.1.1</span> 安装</a></li>
<li><a href="#sec-6400combine" class="nav-link" data-scroll-target="#sec-6400combine"> <span class="header-section-number">5.1.2</span> LI-6400 数据的整合</a></li>
<li><a href="#sec-recompute6400" class="nav-link" data-scroll-target="#sec-recompute6400"> <span class="header-section-number">5.1.3</span> LI-6400 数据重计算</a></li>
</ul></li>
<li><a href="#sec-6800-excel-data" class="nav-link" data-scroll-target="#sec-6800-excel-data"> <span class="header-section-number">5.2</span> LI-6800 Excel 的处理</a>
<ul class="collapse">
<li><a href="#sec-6800xlconnect" class="nav-link" data-scroll-target="#sec-6800xlconnect"> <span class="header-section-number">5.2.1</span> R 下 Excel 格式读取的重计算</a></li>
<li><a href="#sec-6800-readxl-batch" class="nav-link" data-scroll-target="#sec-6800-readxl-batch"> <span class="header-section-number">5.2.2</span> 无需重计算直接读取</a></li>
<li><a href="#sec-6800-import-python" class="nav-link" data-scroll-target="#sec-6800-import-python"> <span class="header-section-number">5.2.3</span> 使用 Python 来处理</a></li>
<li><a href="#sec-6800-batch" class="nav-link" data-scroll-target="#sec-6800-batch"> <span class="header-section-number">5.2.4</span> 批量处理 csv 文件</a></li>
</ul></li>
</ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/zhujiedong/photosynthesis-analysis/edit/master/data-import.qmd" class="toc-action">Edit this page</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content">
<header id="title-block-header">
<h1 class="title display-7"><span id="sec-excel2csv" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">数据读取的选项</span></span></h1>
</header>

<p>鉴于无论是 LI-6400 还是 LI-6800 数据 Excel 格式的复杂性，目前已知的能处理的软件包有 <code>R</code> 的 <a href="https://cran.r-project.org/web/packages/XLConnect/index.html"><code>XLConnect</code></a> 和 <a href="https://www.xlwings.org"><code>xlwings</code></a>，文中对直接下载的 Excel 格式的数据转换，均依赖于此进行。</p>
<section id="sec-6400-excel" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="sec-6400-excel"><span class="header-section-number">5.1</span> LI-6400 Excel 的处理</h2>
<p>todo，解决之前请临时参考原始文件的处理：</p>
<section id="sec-install_readphoto" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="sec-install_readphoto"><span class="header-section-number">5.1.1</span> 安装</h3>
<p>暂时只有我的 github repo 中的版本：</p>
<div class="cell">
<p></p><details open="">
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"zhujiedong/readphoto"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 或</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_git</span>(<span class="st">"https://gitee.com/zhu_jie_dong/readphoto"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="sec-6400combine" class="level3" data-number="5.1.2">
<h3 data-number="5.1.2" class="anchored" data-anchor-id="sec-6400combine"><span class="header-section-number">5.1.2</span> LI-6400 数据的整合</h3>
<p>将所有 LI-6400 的 <strong>原始数据文件</strong> 放置于一个文件夹下，例如下面代码放在了名为 6400 的文件夹内，基本参数如下：</p>
<div class="cell">
<p></p><details open="">
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readphoto)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>df64  <span class="ot">&lt;-</span> <span class="fu">read_bat_6400</span>(<span class="st">"data/6400"</span>, <span class="at">header_line =</span> <span class="dv">17</span>, <span class="at">data_start =</span> <span class="dv">27</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>其中 header_line 是表头所在行，即 <code>obs</code> 开始的那一行的行号，data_start 也就是我们实际测量数据开始的行号，数据输出如下所示(仅显示前8列数据)：</p>
<div class="cell">
<div class="cell-output-display">
<table class="table">
<caption>{} </caption>
<colgroup>
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 2%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">files</th>
<th style="text-align: left;">Obs</th>
<th style="text-align: left;">HHMMSS</th>
<th style="text-align: right;">FTime</th>
<th style="text-align: right;">EBal.</th>
<th style="text-align: right;">Photo</th>
<th style="text-align: right;">Cond</th>
<th style="text-align: right;">Ci</th>
<th style="text-align: right;">Trmmol</th>
<th style="text-align: right;">VpdL</th>
<th style="text-align: right;">CTleaf</th>
<th style="text-align: right;">Area</th>
<th style="text-align: right;">BLC_1</th>
<th style="text-align: right;">StmRat</th>
<th style="text-align: right;">BLCond</th>
<th style="text-align: right;">Tair</th>
<th style="text-align: right;">Tleaf</th>
<th style="text-align: right;">TBlk</th>
<th style="text-align: right;">CO2R</th>
<th style="text-align: right;">CO2S</th>
<th style="text-align: right;">H2OR</th>
<th style="text-align: right;">H2OS</th>
<th style="text-align: right;">RH_R</th>
<th style="text-align: right;">RH_S</th>
<th style="text-align: right;">Flow</th>
<th style="text-align: right;">PARi</th>
<th style="text-align: right;">PARo</th>
<th style="text-align: right;">Press</th>
<th style="text-align: right;">CsMch</th>
<th style="text-align: right;">HsMch</th>
<th style="text-align: right;">CsMchSD</th>
<th style="text-align: right;">HsMchSD</th>
<th style="text-align: right;">CrMchSD</th>
<th style="text-align: right;">HrMchSD</th>
<th style="text-align: right;">StableF</th>
<th style="text-align: right;">BLCslope</th>
<th style="text-align: right;">BLCoffst</th>
<th style="text-align: right;">f_parin</th>
<th style="text-align: right;">f_parout</th>
<th style="text-align: right;">alphaK</th>
<th style="text-align: right;">Status</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">aci</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">10:55:14</td>
<td style="text-align: right;">483.0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">6.990</td>
<td style="text-align: right;">0.0831</td>
<td style="text-align: right;">251.0</td>
<td style="text-align: right;">0.456</td>
<td style="text-align: right;">0.501</td>
<td style="text-align: right;">21.35</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.42</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.84</td>
<td style="text-align: right;">20.52</td>
<td style="text-align: right;">21.35</td>
<td style="text-align: right;">20.08</td>
<td style="text-align: right;">400.11</td>
<td style="text-align: right;">391.51</td>
<td style="text-align: right;">22.012</td>
<td style="text-align: right;">22.547</td>
<td style="text-align: right;">82.53</td>
<td style="text-align: right;">84.54</td>
<td style="text-align: right;">500.2</td>
<td style="text-align: right;">800</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">90.88</td>
<td style="text-align: right;">1.820</td>
<td style="text-align: right;">-0.305</td>
<td style="text-align: right;">0.03860</td>
<td style="text-align: right;">0.001870</td>
<td style="text-align: right;">0.01340</td>
<td style="text-align: right;">0.001280</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.22</td>
<td style="text-align: right;">2.74</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">111115</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: left;">aci</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">10:57:35</td>
<td style="text-align: right;">623.5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">5.160</td>
<td style="text-align: right;">0.0853</td>
<td style="text-align: right;">192.0</td>
<td style="text-align: right;">0.465</td>
<td style="text-align: right;">0.497</td>
<td style="text-align: right;">21.36</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.42</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.84</td>
<td style="text-align: right;">20.53</td>
<td style="text-align: right;">21.36</td>
<td style="text-align: right;">20.08</td>
<td style="text-align: right;">299.93</td>
<td style="text-align: right;">293.58</td>
<td style="text-align: right;">22.066</td>
<td style="text-align: right;">22.611</td>
<td style="text-align: right;">82.70</td>
<td style="text-align: right;">84.74</td>
<td style="text-align: right;">500.2</td>
<td style="text-align: right;">800</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">90.88</td>
<td style="text-align: right;">1.680</td>
<td style="text-align: right;">-0.307</td>
<td style="text-align: right;">0.03440</td>
<td style="text-align: right;">0.001150</td>
<td style="text-align: right;">0.03040</td>
<td style="text-align: right;">0.000986</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.22</td>
<td style="text-align: right;">2.74</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">111115</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7</td>
<td style="text-align: left;">aci</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">10:59:55</td>
<td style="text-align: right;">763.5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3.140</td>
<td style="text-align: right;">0.0881</td>
<td style="text-align: right;">136.0</td>
<td style="text-align: right;">0.476</td>
<td style="text-align: right;">0.494</td>
<td style="text-align: right;">21.36</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.42</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.84</td>
<td style="text-align: right;">20.53</td>
<td style="text-align: right;">21.36</td>
<td style="text-align: right;">20.08</td>
<td style="text-align: right;">200.16</td>
<td style="text-align: right;">196.28</td>
<td style="text-align: right;">22.095</td>
<td style="text-align: right;">22.653</td>
<td style="text-align: right;">82.81</td>
<td style="text-align: right;">84.90</td>
<td style="text-align: right;">500.2</td>
<td style="text-align: right;">800</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">90.88</td>
<td style="text-align: right;">1.480</td>
<td style="text-align: right;">-0.309</td>
<td style="text-align: right;">0.01280</td>
<td style="text-align: right;">0.001140</td>
<td style="text-align: right;">0.01150</td>
<td style="text-align: right;">0.000535</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.22</td>
<td style="text-align: right;">2.74</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">111115</td>
</tr>
<tr class="even">
<td style="text-align: left;">10</td>
<td style="text-align: left;">aci</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">11:02:26</td>
<td style="text-align: right;">914.5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.910</td>
<td style="text-align: right;">0.0927</td>
<td style="text-align: right;">81.9</td>
<td style="text-align: right;">0.496</td>
<td style="text-align: right;">0.490</td>
<td style="text-align: right;">21.36</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.42</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.84</td>
<td style="text-align: right;">20.53</td>
<td style="text-align: right;">21.36</td>
<td style="text-align: right;">20.08</td>
<td style="text-align: right;">99.98</td>
<td style="text-align: right;">98.83</td>
<td style="text-align: right;">22.108</td>
<td style="text-align: right;">22.690</td>
<td style="text-align: right;">82.85</td>
<td style="text-align: right;">85.03</td>
<td style="text-align: right;">500.2</td>
<td style="text-align: right;">800</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">90.88</td>
<td style="text-align: right;">1.050</td>
<td style="text-align: right;">-0.309</td>
<td style="text-align: right;">0.03030</td>
<td style="text-align: right;">0.000609</td>
<td style="text-align: right;">0.01740</td>
<td style="text-align: right;">0.001070</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.22</td>
<td style="text-align: right;">2.74</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">111115</td>
</tr>
<tr class="odd">
<td style="text-align: left;">13</td>
<td style="text-align: left;">aci</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">11:04:46</td>
<td style="text-align: right;">1055.0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-0.167</td>
<td style="text-align: right;">0.0966</td>
<td style="text-align: right;">52.7</td>
<td style="text-align: right;">0.514</td>
<td style="text-align: right;">0.487</td>
<td style="text-align: right;">21.36</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.42</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.84</td>
<td style="text-align: right;">20.53</td>
<td style="text-align: right;">21.36</td>
<td style="text-align: right;">20.08</td>
<td style="text-align: right;">50.16</td>
<td style="text-align: right;">50.33</td>
<td style="text-align: right;">22.109</td>
<td style="text-align: right;">22.712</td>
<td style="text-align: right;">82.87</td>
<td style="text-align: right;">85.13</td>
<td style="text-align: right;">500.2</td>
<td style="text-align: right;">800</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">90.87</td>
<td style="text-align: right;">0.782</td>
<td style="text-align: right;">-0.312</td>
<td style="text-align: right;">0.00765</td>
<td style="text-align: right;">0.001010</td>
<td style="text-align: right;">0.00661</td>
<td style="text-align: right;">0.001080</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.22</td>
<td style="text-align: right;">2.74</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">111115</td>
</tr>
<tr class="even">
<td style="text-align: left;">16</td>
<td style="text-align: left;">aci</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">11:07:23</td>
<td style="text-align: right;">1211.5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">5.240</td>
<td style="text-align: right;">0.1010</td>
<td style="text-align: right;">305.0</td>
<td style="text-align: right;">0.532</td>
<td style="text-align: right;">0.484</td>
<td style="text-align: right;">21.35</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.42</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.84</td>
<td style="text-align: right;">20.53</td>
<td style="text-align: right;">21.35</td>
<td style="text-align: right;">20.08</td>
<td style="text-align: right;">400.05</td>
<td style="text-align: right;">393.50</td>
<td style="text-align: right;">22.117</td>
<td style="text-align: right;">22.740</td>
<td style="text-align: right;">82.91</td>
<td style="text-align: right;">85.24</td>
<td style="text-align: right;">500.2</td>
<td style="text-align: right;">800</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">90.87</td>
<td style="text-align: right;">1.790</td>
<td style="text-align: right;">-0.308</td>
<td style="text-align: right;">0.07960</td>
<td style="text-align: right;">0.001280</td>
<td style="text-align: right;">0.05430</td>
<td style="text-align: right;">0.000927</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.22</td>
<td style="text-align: right;">2.74</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">111115</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>如果想另存为 csv 格式：</p>
<div class="cell">
<p></p><details open="">
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(df64, <span class="st">"./combined.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>header_line 表示你数据表头所在行，data_start 表示你数据起始行，Obs = 1 时所在行，不含表头。这个也要确认好了，不同的测量不能放在一起（务必不要混淆，不然所有数据会放在一个文件夹内），不同的测量可能起始行不同，这样就会报错。</p>
<p>其中，数据的来源在表格中第一列，叫做 files，是数据来源的文件名（即你起的名字）,例如本例中你看到的 aci 是我之前数据里面 aci 响应曲线的数据。</p>
<p>这些数据可以用于后文相关的分析中，尤其是像 <code>fitacis</code> 这样的函数，因为本质上他们都是符合 <code>tidyverse</code> 样式的数据。</p>
</section>
<section id="sec-recompute6400" class="level3" data-number="5.1.3">
<h3 data-number="5.1.3" class="anchored" data-anchor-id="sec-recompute6400"><span class="header-section-number">5.1.3</span> LI-6400 数据重计算</h3>
<p>参数的重计算函数为 <code>recomp_6400</code>, 其参数除了 <code>read_bat_6400</code> 所包含的参数外，还有叶面积 S, 以及叶片正反面的气孔比例，默认值分别为 6 和 0.5。</p>
<div class="cell">
<p></p><details open="">
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readphoto)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">read_bat_6400</span>(<span class="st">"./data/6400"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">recomp_6400</span>(<span class="st">"./data/6400"</span>, <span class="at">header_line =</span> <span class="dv">17</span>, <span class="at">data_start =</span> <span class="dv">27</span>, <span class="at">S =</span> <span class="dv">6</span>, <span class="at">K =</span> <span class="fl">0.5</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>x1<span class="sc">$</span>Photo <span class="sc">-</span> y1<span class="sc">$</span>Photo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-stdout">
<pre><code> [1] -0.0008873753  0.0026900500 -0.0012036469  0.0003483414  0.0006122641
 [6] -0.0113872639 -0.0020986076  0.0004962787  0.0188727482 -0.0294595908
[11] -0.0436611445 -0.0339083408  0.0046772165  0.0036653298  0.0030397988
[16] -0.0105901673  0.0040624956  0.0017317049 -0.0073252290  0.0054977377
[21]  0.0039736503  0.0021704065  0.0046772165  0.0036653298  0.0030397988
[26] -0.0105901673  0.0040624956  0.0017317049 -0.0073252290  0.0054977377
[31]  0.0039736503  0.0021704065</code></pre>
</div>
<p></p><details open="">
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>x1<span class="sc">$</span>Trmmol <span class="sc">-</span> y1<span class="sc">$</span>Trmmol</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-stdout">
<pre><code> [1] -2.998596e-04  1.407338e-04  3.189451e-05 -4.586467e-04 -3.836822e-04
 [6]  5.402725e-04 -2.344852e-04 -7.684772e-05  5.979599e-04 -6.534341e-04
[11] -6.779145e-04  2.469749e-04  3.812201e-04  2.313957e-04  3.508312e-04
[16] -2.794358e-04 -5.406530e-04  5.230606e-04 -9.183370e-04  7.638850e-04
[21] -2.578893e-04  2.203045e-04  3.812201e-04  2.313957e-04  3.508312e-04
[26] -2.794358e-04 -5.406530e-04  5.230606e-04 -9.183370e-04  7.638850e-04
[31] -2.578893e-04  2.203045e-04</code></pre>
</div>
<p></p><details open="">
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>x1<span class="sc">$</span>Cond <span class="sc">-</span> y1<span class="sc">$</span>Cond</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-stdout">
<pre><code> [1] -1.974217e-04 -3.594216e-04 -3.779119e-04 -3.806675e-04 -3.201411e-04
 [6] -1.483324e-04 -7.803345e-04 -2.671018e-04  1.028977e-04 -3.966192e-04
[11] -3.190769e-04 -2.314266e-04 -2.746300e-04  1.094050e-05 -4.584791e-05
[16] -1.084094e-04 -1.827768e-04 -1.344969e-04 -1.714096e-04 -8.180257e-05
[21] -4.687906e-05 -1.000424e-04 -2.746300e-04  1.094050e-05 -4.584791e-05
[26] -1.084094e-04 -1.827768e-04 -1.344969e-04 -1.714096e-04 -8.180257e-05
[31] -4.687906e-05 -1.000424e-04</code></pre>
</div>
<p></p><details open="">
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>x1<span class="sc">$</span>Ci<span class="sc">-</span>y1<span class="sc">$</span>Ci</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-stdout">
<pre><code> [1]  0.434643936 -0.297820404 -0.308200950 -0.007847373 -0.035490198
 [6]  0.433706824 -0.416734067 -0.052089770  0.147655545 -0.315797917
[11] -0.271335987 -0.228968795  0.356519198  0.311487646  0.052196075
[16]  0.557128947  0.058563406  0.300198435  0.052607786  0.339000061
[21] -0.252622980 -0.494554616  0.356519198  0.311487646  0.052196075
[26]  0.557128947  0.058563406  0.300198435  0.052607786  0.339000061
[31] -0.252622980 -0.494554616</code></pre>
</div>
<p></p><details open="">
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># half of original the area</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">recomp_6400</span>(<span class="st">"./data/6400"</span>,  <span class="at">header_line =</span> <span class="dv">17</span>, <span class="at">data_start =</span> <span class="dv">27</span>, <span class="at">S =</span> <span class="dv">3</span>, <span class="at">K =</span> <span class="fl">0.5</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>y1<span class="sc">$</span>Photo<span class="sc">/</span>x1<span class="sc">$</span>Photo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-stdout">
<pre><code> [1] 2.000254 1.998957 2.000767 1.999234 2.007333 2.004346 2.000635 1.999893
 [9] 1.996299 2.005611 2.008161 2.006110 1.998550 1.998863 1.998980 2.003671
[17] 1.998391 1.999240 2.003866 1.995584 1.994199 2.010360 1.998550 1.998863
[25] 1.998980 2.003671 1.998391 1.999240 2.003866 1.995584 1.994199 2.010360</code></pre>
</div>
<p></p><details open="">
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test with random area less than six</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>area <span class="ot">&lt;-</span> <span class="dv">6</span> <span class="sc">-</span> <span class="fu">runif</span>(<span class="dv">32</span>, <span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">recomp_6400</span>(<span class="st">"./data/6400"</span>,  <span class="at">header_line =</span> <span class="dv">17</span>, <span class="at">data_start =</span> <span class="dv">27</span>, <span class="at">S =</span> area, <span class="at">K =</span> <span class="fl">0.5</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>y1<span class="sc">$</span>Photo<span class="sc">/</span>x1<span class="sc">$</span>Photo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-stdout">
<pre><code> [1] 1.618012 1.700436 1.385868 1.485642 1.943026 1.204106 1.227391 1.264499
 [9] 1.511262 1.574247 1.244826 1.595690 1.257169 1.658833 1.631710 1.350819
[17] 1.884562 1.715913 1.614464 1.282143 1.242243 1.402776 1.761523 1.809071
[25] 1.496105 1.417426 1.827321 1.628820 1.309040 1.335277 1.831048 1.822457</code></pre>
</div>
</div>
<p>我们看到各个值之差非常小，因为我们使用的是相同的叶面积，理论上这两次读数的差异应为 0， 但在实际计算过程中，有小数点位数的影响，所以某些值不完全为 0，但该差值足够小。我们将所有的数据叶面积减半后，二者比值也约等于 2.</p>
</section>
</section>
<section id="sec-6800-excel-data" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="sec-6800-excel-data"><span class="header-section-number">5.2</span> LI-6800 Excel 的处理</h2>
<p>LI-6800 的数据我们可以直接处理 Excel 即可，我们分开来看两种方式：</p>
<section id="sec-6800xlconnect" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="sec-6800xlconnect"><span class="header-section-number">5.2.1</span> R 下 Excel 格式读取的重计算</h3>
<p><code>XLConnect</code> 直接读取功能比较麻烦，为了节省时间，我将其写成了函数，放在了我的 <code>readphoto</code> 软件包里，软件包的安装参考 <a href="#sec-install_readphoto">小节&nbsp;<span>5.1.1</span></a> ：</p>
<p>当然，最近连我自己安装 github 的软件包都经常出问题，如果大家同样遇到问题，可以按照下面的方式安装：</p>
<p>它的参数很少，主要作用为：</p>
<ul>
<li><p>path 是 Excel 文件的路径；</p></li>
<li><p>start_row 是数据开始的行号；</p></li>
<li><p>S 为修改的叶面积，默认值为 6，如果叶面积无需更改，则使用默认的 NULL。如果叶面积非默认值，该值必须输入一个长度和测量值数量完全一致的向量，例如，一共有三个测量值，只有第一个叶片没充满叶室，面积为 1.5，其他的为 2，则输入方式为 S = c(1.5, 2, 2)。</p></li>
</ul>
<p>我们直接使用下面的例子解释，导入的数据是 6 cm<sup>2</sup> 的默认面积：</p>
<div class="cell">
<p></p><details open="">
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readphoto)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>df6 <span class="ot">&lt;-</span> <span class="fu">xlconnect_read</span>(<span class="st">"./data/aci-xlc.xlsx"</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>df6<span class="sc">$</span>A</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-stdout">
<pre><code> [1] 24.7381184 18.1379358 10.8055345  3.0239340 -0.9144044 26.9519572
 [7] 27.5088717 40.9101889 50.1393342 55.3865984 58.0662751 59.3556428</code></pre>
</div>
<p></p><details open="">
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>df3 <span class="ot">&lt;-</span> <span class="fu">xlconnect_read</span>(<span class="st">"./data/aci-xlc.xlsx"</span>, <span class="at">S =</span> <span class="fu">rep</span>(<span class="dv">3</span>, <span class="dv">12</span>))</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>df6<span class="sc">$</span>A<span class="sc">/</span>df3<span class="sc">$</span>A</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-stdout">
<pre><code> [1] 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5</code></pre>
</div>
<p></p><details open="">
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>df_random <span class="ot">&lt;-</span> <span class="fu">xlconnect_read</span>(<span class="st">"./data/aci-xlc.xlsx"</span>, <span class="at">S =</span> <span class="fu">rnorm</span>(<span class="dv">12</span>, <span class="dv">3</span>, <span class="fl">0.1</span>))</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>df6<span class="sc">$</span>A<span class="sc">/</span>df_random<span class="sc">$</span>A</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-stdout">
<pre><code> [1] 0.4978743 0.4860789 0.4850564 0.4941572 0.4957204 0.5197921 0.4926566
 [8] 0.5143717 0.5107993 0.5026447 0.4826154 0.5093796</code></pre>
</div>
</div>
<p>光合速率的倍数的变化在预期之内。</p>
</section>
<section id="sec-6800-readxl-batch" class="level3" data-number="5.2.2">
<h3 data-number="5.2.2" class="anchored" data-anchor-id="sec-6800-readxl-batch"><span class="header-section-number">5.2.2</span> 无需重计算直接读取</h3>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
注意
</div>
</div>
<div class="callout-body-container callout-body">
<p>该功能需要启用 excel 的迭代计算，具体为<strong>文件 –&gt; 选项–&gt; 公式 –&gt; 启动迭代计算</strong>，否则导入的带公式的单元格数值为 0。</p>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://s4.ax1x.com/2022/01/25/7HarSf.gif" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">7HarSf.gif</figcaption><p></p>
</figure>
</div>
<section id="安装" class="level4">
<h4 class="anchored" data-anchor-id="安装">安装</h4>
<div class="cell">
<p></p><details open="">
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("devtools")</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co">#devtools::install_github("zhujiedong/ReadLICOR6800")</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_git</span>(<span class="st">"https://gitee.com/zhu_jie_dong/ReadLICOR6800"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>使用比较简单，第一个函数用于读取单个数据文件：</p>
<div class="cell">
<p></p><details open="">
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ReadLICOR6800)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>aci <span class="ot">&lt;-</span> <span class="fu">read_li6800</span>(<span class="st">'data/batch6800/racirtest1.xlsx'</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>aci[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-stdout">
<pre><code>   obs         time elapsed              date   hhmmss averaging
15   1 1617082892.5       0 20210330 13:41:32 13:41:32         2
16   2   1617082895     2.5 20210330 13:41:35 13:41:35         2
17   3 1617082896.5       4 20210330 13:41:36 13:41:36         2</code></pre>
</div>
<p></p><details open="">
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(aci)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-stdout">
<pre><code>  [1] "obs"            "time"           "elapsed"        "date"          
  [5] "hhmmss"         "averaging"      "TIME"           "E"             
  [9] "Emm"            "A"              "Ca"             "Ci"            
 [13] "Pci"            "Pca"            "gsw"            "gbw"           
 [17] "gtw"            "gtc"            "Rabs"           "TleafEB"       
 [21] "TleafCnd"       "SVPleaf"        "RHcham"         "VPcham"        
 [25] "SVPcham"        "VPDleaf"        "LatHFlux"       "SenHFlux"      
 [29] "NetTherm"       "EBSum"          "Asty"           "Esty"          
 [33] "Adyn"           "Crd"            "Csd"            "dCsd/dt"       
 [37] "αVc"            "Edyn"           "Hr"             "Hs"            
 [41] "dHs/dt"         "αVh"            "Leak"           "LeakPct"       
 [45] "CorrFact"       "CorrFactPct"    "Fan"            "DarkAdaptedID" 
 [49] "Qmax_d"         "Fo"             "Fm"             "Fv/Fm"         
 [53] "A_dark"         "LightAdaptedID" "Qmax"           "Fs"            
 [57] "Fm'"            "PhiPS2"         "PS2/1"          "Qabs_fs"       
 [61] "A_fs"           "ETR"            "PhiCO2"         "NPQ"           
 [65] "alt. Fo'"       "DarkPulseID"    "Fmin"           "Fo'"           
 [69] "Fv'/Fm'"        "qP"             "qN"             "qP_Fo"         
 [73] "qN_Fo"          "qL"             "1-qL"           "Qin"           
 [77] "Qabs"           "alpha"          "convert"        "S"             
 [81] "K"              "Geometry"       "Custom"         "UseDynamic"    
 [85] "TIME"           "CO2_s"          "CO2_r"          "H2O_s"         
 [89] "H2O_r"          "CO2_a"          "H2O_a"          "Flow"          
 [93] "Pa"             "ΔPcham"         "Tair"           "Tleaf"         
 [97] "Tleaf2"         "Offset"         "Offset2"        "Fan_speed"     
[101] "Qamb_in"        "Qamb_out"       "Q"              "f_red"         
[105] "f_blue"         "f_farred"       "F"              "Q_modavg"      
[109] "F_dc"           "Pc"             "Tled"           "TDigital"      
[113] "TPreamp"        "TPwrSpy"        "TDrive"         "Q_red"         
[117] "Q_blue"         "Q_farred"       "TSPF"           "state"         
[121] "F_avg"          "dF/dt"          "dF_dc/dt"       "F_dc_avg"      
[125] "period"         "time"           "hhmmss"         "co2_t"         
[129] "h2o_t"          "count"          "co2_adj"        "h2o_adj"       
[133] "co2_match"      "h2o_match"      "co2_at"         "h2o_at"        
[137] "co2_cv"         "h2o_cv"         "MatchValveR"    "MatchValveS"   
[141] "MatchCO2"       "MatchH2O"       "cf_co2_a"       "cf_co2_b"      
[145] "cf_co2_c"       "cf_co2_d"       "cf_h2o_a"       "cf_h2o_b"      
[149] "cf_h2o_c"       "cf_h2o_d"       "co2_fit_low"    "co2_fit_high"  
[153] "h2o_fit_low"    "h2o_fit_high"   "co2_elapsed"    "h2o_elapsed"   
[157] "DIAG"           "Flow_s"         "Flow_r"         "Txchg"         
[161] "Tirga"          "Tchopper"       "Ts"             "Tr"            
[165] "CO2_%"          "Desiccant_%"    "Humidifier_%"   "Txchg_sp"      
[169] "CO2_r_sp"       "H2O_r_sp"       "SS_s"           "SS_r"          
[173] "data_tag"      </code></pre>
</div>
<p></p><details open="">
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>aci<span class="sc">$</span>data_tag</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-stdout">
<pre><code>  [1] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
  [6] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
 [11] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
 [16] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
 [21] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
 [26] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
 [31] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
 [36] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
 [41] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
 [46] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
 [51] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
 [56] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
 [61] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
 [66] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
 [71] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
 [76] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
 [81] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
 [86] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
 [91] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
 [96] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
[101] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
[106] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
[111] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
[116] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
[121] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
[126] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
[131] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
[136] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
[141] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
[146] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
[151] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
[156] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
[161] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
[166] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
[171] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
[176] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
[181] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
[186] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
[191] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
[196] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
[201] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
[206] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
[211] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
[216] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
[221] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
[226] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
[231] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
[236] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
[241] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
[246] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
[251] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
[256] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
[261] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
[266] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
[271] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
[276] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
[281] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
[286] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
[291] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
[296] "racirtest1" "racirtest1" "racirtest1"</code></pre>
</div>
</div>
<p>默认的参数会添加 <code>data_tag</code> 列，用于读取多个文件时候区分数据用，默认的不坐修改的标签是文件名，若要修改，指定 <code>tags</code> 参数为我们需要的标签即可。</p>
<p>若单纯读取单个文件，也没有必要加标签，但加或者不加对我们分析数据没有任何影响：</p>
<div class="cell">
<p></p><details open="">
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>aci <span class="ot">&lt;-</span> <span class="fu">read_li6800</span>(<span class="st">"data/batch6800/racirtest1.xlsx"</span>, <span class="at">add_tags =</span> <span class="cn">FALSE</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(aci)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-stdout">
<pre><code>  [1] "obs"            "time"           "elapsed"        "date"          
  [5] "hhmmss"         "averaging"      "TIME"           "E"             
  [9] "Emm"            "A"              "Ca"             "Ci"            
 [13] "Pci"            "Pca"            "gsw"            "gbw"           
 [17] "gtw"            "gtc"            "Rabs"           "TleafEB"       
 [21] "TleafCnd"       "SVPleaf"        "RHcham"         "VPcham"        
 [25] "SVPcham"        "VPDleaf"        "LatHFlux"       "SenHFlux"      
 [29] "NetTherm"       "EBSum"          "Asty"           "Esty"          
 [33] "Adyn"           "Crd"            "Csd"            "dCsd/dt"       
 [37] "αVc"            "Edyn"           "Hr"             "Hs"            
 [41] "dHs/dt"         "αVh"            "Leak"           "LeakPct"       
 [45] "CorrFact"       "CorrFactPct"    "Fan"            "DarkAdaptedID" 
 [49] "Qmax_d"         "Fo"             "Fm"             "Fv/Fm"         
 [53] "A_dark"         "LightAdaptedID" "Qmax"           "Fs"            
 [57] "Fm'"            "PhiPS2"         "PS2/1"          "Qabs_fs"       
 [61] "A_fs"           "ETR"            "PhiCO2"         "NPQ"           
 [65] "alt. Fo'"       "DarkPulseID"    "Fmin"           "Fo'"           
 [69] "Fv'/Fm'"        "qP"             "qN"             "qP_Fo"         
 [73] "qN_Fo"          "qL"             "1-qL"           "Qin"           
 [77] "Qabs"           "alpha"          "convert"        "S"             
 [81] "K"              "Geometry"       "Custom"         "UseDynamic"    
 [85] "TIME"           "CO2_s"          "CO2_r"          "H2O_s"         
 [89] "H2O_r"          "CO2_a"          "H2O_a"          "Flow"          
 [93] "Pa"             "ΔPcham"         "Tair"           "Tleaf"         
 [97] "Tleaf2"         "Offset"         "Offset2"        "Fan_speed"     
[101] "Qamb_in"        "Qamb_out"       "Q"              "f_red"         
[105] "f_blue"         "f_farred"       "F"              "Q_modavg"      
[109] "F_dc"           "Pc"             "Tled"           "TDigital"      
[113] "TPreamp"        "TPwrSpy"        "TDrive"         "Q_red"         
[117] "Q_blue"         "Q_farred"       "TSPF"           "state"         
[121] "F_avg"          "dF/dt"          "dF_dc/dt"       "F_dc_avg"      
[125] "period"         "time"           "hhmmss"         "co2_t"         
[129] "h2o_t"          "count"          "co2_adj"        "h2o_adj"       
[133] "co2_match"      "h2o_match"      "co2_at"         "h2o_at"        
[137] "co2_cv"         "h2o_cv"         "MatchValveR"    "MatchValveS"   
[141] "MatchCO2"       "MatchH2O"       "cf_co2_a"       "cf_co2_b"      
[145] "cf_co2_c"       "cf_co2_d"       "cf_h2o_a"       "cf_h2o_b"      
[149] "cf_h2o_c"       "cf_h2o_d"       "co2_fit_low"    "co2_fit_high"  
[153] "h2o_fit_low"    "h2o_fit_high"   "co2_elapsed"    "h2o_elapsed"   
[157] "DIAG"           "Flow_s"         "Flow_r"         "Txchg"         
[161] "Tirga"          "Tchopper"       "Ts"             "Tr"            
[165] "CO2_%"          "Desiccant_%"    "Humidifier_%"   "Txchg_sp"      
[169] "CO2_r_sp"       "H2O_r_sp"       "SS_s"           "SS_r"          </code></pre>
</div>
<p></p><details open="">
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(aci<span class="sc">$</span>data_tags)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
</div>
</section>
<section id="批量读取多个数据文件" class="level4">
<h4 class="anchored" data-anchor-id="批量读取多个数据文件">批量读取多个数据文件</h4>
<p>与上面的函数类似，本身就是对其进行了包裹，方便不熟悉使用的人能够一次批量读取所有文件，需要注意所有文件的列数必须相同，这多数时候不会出现问题，多台光合仪同时使用时配置文件一致即可。否则只能分开读取再合并。使用 <code>tags=NULL</code>(默认), <code>data_tag</code>会显示文件名：</p>
<div class="cell">
<p></p><details open="">
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">list.files</span>(<span class="st">"data/batch6800/"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-stdout">
<pre><code>[1] "racirtest1.xlsx" "racirtest3.xlsx"</code></pre>
</div>
<p></p><details open="">
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>aci <span class="ot">&lt;-</span> <span class="fu">read_li6800_folder</span>(<span class="st">"data/batch6800/"</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(aci)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-stdout">
<pre><code>  [1] "obs"            "time"           "elapsed"        "date"          
  [5] "hhmmss"         "averaging"      "TIME"           "E"             
  [9] "Emm"            "A"              "Ca"             "Ci"            
 [13] "Pci"            "Pca"            "gsw"            "gbw"           
 [17] "gtw"            "gtc"            "Rabs"           "TleafEB"       
 [21] "TleafCnd"       "SVPleaf"        "RHcham"         "VPcham"        
 [25] "SVPcham"        "VPDleaf"        "LatHFlux"       "SenHFlux"      
 [29] "NetTherm"       "EBSum"          "Asty"           "Esty"          
 [33] "Adyn"           "Crd"            "Csd"            "dCsd/dt"       
 [37] "αVc"            "Edyn"           "Hr"             "Hs"            
 [41] "dHs/dt"         "αVh"            "Leak"           "LeakPct"       
 [45] "CorrFact"       "CorrFactPct"    "Fan"            "DarkAdaptedID" 
 [49] "Qmax_d"         "Fo"             "Fm"             "Fv/Fm"         
 [53] "A_dark"         "LightAdaptedID" "Qmax"           "Fs"            
 [57] "Fm'"            "PhiPS2"         "PS2/1"          "Qabs_fs"       
 [61] "A_fs"           "ETR"            "PhiCO2"         "NPQ"           
 [65] "alt. Fo'"       "DarkPulseID"    "Fmin"           "Fo'"           
 [69] "Fv'/Fm'"        "qP"             "qN"             "qP_Fo"         
 [73] "qN_Fo"          "qL"             "1-qL"           "Qin"           
 [77] "Qabs"           "alpha"          "convert"        "S"             
 [81] "K"              "Geometry"       "Custom"         "UseDynamic"    
 [85] "TIME"           "CO2_s"          "CO2_r"          "H2O_s"         
 [89] "H2O_r"          "CO2_a"          "H2O_a"          "Flow"          
 [93] "Pa"             "ΔPcham"         "Tair"           "Tleaf"         
 [97] "Tleaf2"         "Offset"         "Offset2"        "Fan_speed"     
[101] "Qamb_in"        "Qamb_out"       "Q"              "f_red"         
[105] "f_blue"         "f_farred"       "F"              "Q_modavg"      
[109] "F_dc"           "Pc"             "Tled"           "TDigital"      
[113] "TPreamp"        "TPwrSpy"        "TDrive"         "Q_red"         
[117] "Q_blue"         "Q_farred"       "TSPF"           "state"         
[121] "F_avg"          "dF/dt"          "dF_dc/dt"       "F_dc_avg"      
[125] "period"         "time"           "hhmmss"         "co2_t"         
[129] "h2o_t"          "count"          "co2_adj"        "h2o_adj"       
[133] "co2_match"      "h2o_match"      "co2_at"         "h2o_at"        
[137] "co2_cv"         "h2o_cv"         "MatchValveR"    "MatchValveS"   
[141] "MatchCO2"       "MatchH2O"       "cf_co2_a"       "cf_co2_b"      
[145] "cf_co2_c"       "cf_co2_d"       "cf_h2o_a"       "cf_h2o_b"      
[149] "cf_h2o_c"       "cf_h2o_d"       "co2_fit_low"    "co2_fit_high"  
[153] "h2o_fit_low"    "h2o_fit_high"   "co2_elapsed"    "h2o_elapsed"   
[157] "DIAG"           "Flow_s"         "Flow_r"         "Txchg"         
[161] "Tirga"          "Tchopper"       "Ts"             "Tr"            
[165] "CO2_%"          "Desiccant_%"    "Humidifier_%"   "Txchg_sp"      
[169] "CO2_r_sp"       "H2O_r_sp"       "SS_s"           "SS_r"          
[173] "data_tag"      </code></pre>
</div>
<p></p><details open="">
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(aci<span class="sc">$</span>data_tag)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-stdout">
<pre><code>[1] "racirtest1" "racirtest1" "racirtest1" "racirtest1" "racirtest1"
[6] "racirtest1"</code></pre>
</div>
<p></p><details open="">
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(aci<span class="sc">$</span>data_tag)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-stdout">
<pre><code>[1] "racirtest3" "racirtest3" "racirtest3" "racirtest3" "racirtest3"
[6] "racirtest3"</code></pre>
</div>
</div>
<p>当指定自定义标签时，需要 <code>tags</code> 给出的标签的长度和顺序要与 <code>list.files()</code> 显示的一致才可以。</p>
<div class="cell">
<p></p><details open="">
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>aci <span class="ot">&lt;-</span> <span class="fu">read_li6800_folder</span>(<span class="st">"data/batch6800/"</span>, <span class="at">tags =</span> <span class="fu">paste</span>(<span class="st">'test'</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>))</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>aci[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-stdout">
<pre><code>  obs         time elapsed              date   hhmmss averaging
1   1 1617082892.5       0 20210330 13:41:32 13:41:32         2
2   2   1617082895     2.5 20210330 13:41:35 13:41:35         2
3   3 1617082896.5       4 20210330 13:41:36 13:41:36         2</code></pre>
</div>
<p></p><details open="">
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(aci)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-stdout">
<pre><code>  [1] "obs"            "time"           "elapsed"        "date"          
  [5] "hhmmss"         "averaging"      "TIME"           "E"             
  [9] "Emm"            "A"              "Ca"             "Ci"            
 [13] "Pci"            "Pca"            "gsw"            "gbw"           
 [17] "gtw"            "gtc"            "Rabs"           "TleafEB"       
 [21] "TleafCnd"       "SVPleaf"        "RHcham"         "VPcham"        
 [25] "SVPcham"        "VPDleaf"        "LatHFlux"       "SenHFlux"      
 [29] "NetTherm"       "EBSum"          "Asty"           "Esty"          
 [33] "Adyn"           "Crd"            "Csd"            "dCsd/dt"       
 [37] "αVc"            "Edyn"           "Hr"             "Hs"            
 [41] "dHs/dt"         "αVh"            "Leak"           "LeakPct"       
 [45] "CorrFact"       "CorrFactPct"    "Fan"            "DarkAdaptedID" 
 [49] "Qmax_d"         "Fo"             "Fm"             "Fv/Fm"         
 [53] "A_dark"         "LightAdaptedID" "Qmax"           "Fs"            
 [57] "Fm'"            "PhiPS2"         "PS2/1"          "Qabs_fs"       
 [61] "A_fs"           "ETR"            "PhiCO2"         "NPQ"           
 [65] "alt. Fo'"       "DarkPulseID"    "Fmin"           "Fo'"           
 [69] "Fv'/Fm'"        "qP"             "qN"             "qP_Fo"         
 [73] "qN_Fo"          "qL"             "1-qL"           "Qin"           
 [77] "Qabs"           "alpha"          "convert"        "S"             
 [81] "K"              "Geometry"       "Custom"         "UseDynamic"    
 [85] "TIME"           "CO2_s"          "CO2_r"          "H2O_s"         
 [89] "H2O_r"          "CO2_a"          "H2O_a"          "Flow"          
 [93] "Pa"             "ΔPcham"         "Tair"           "Tleaf"         
 [97] "Tleaf2"         "Offset"         "Offset2"        "Fan_speed"     
[101] "Qamb_in"        "Qamb_out"       "Q"              "f_red"         
[105] "f_blue"         "f_farred"       "F"              "Q_modavg"      
[109] "F_dc"           "Pc"             "Tled"           "TDigital"      
[113] "TPreamp"        "TPwrSpy"        "TDrive"         "Q_red"         
[117] "Q_blue"         "Q_farred"       "TSPF"           "state"         
[121] "F_avg"          "dF/dt"          "dF_dc/dt"       "F_dc_avg"      
[125] "period"         "time"           "hhmmss"         "co2_t"         
[129] "h2o_t"          "count"          "co2_adj"        "h2o_adj"       
[133] "co2_match"      "h2o_match"      "co2_at"         "h2o_at"        
[137] "co2_cv"         "h2o_cv"         "MatchValveR"    "MatchValveS"   
[141] "MatchCO2"       "MatchH2O"       "cf_co2_a"       "cf_co2_b"      
[145] "cf_co2_c"       "cf_co2_d"       "cf_h2o_a"       "cf_h2o_b"      
[149] "cf_h2o_c"       "cf_h2o_d"       "co2_fit_low"    "co2_fit_high"  
[153] "h2o_fit_low"    "h2o_fit_high"   "co2_elapsed"    "h2o_elapsed"   
[157] "DIAG"           "Flow_s"         "Flow_r"         "Txchg"         
[161] "Tirga"          "Tchopper"       "Ts"             "Tr"            
[165] "CO2_%"          "Desiccant_%"    "Humidifier_%"   "Txchg_sp"      
[169] "CO2_r_sp"       "H2O_r_sp"       "SS_s"           "SS_r"          
[173] "data_tag"      </code></pre>
</div>
<p></p><details open="">
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(aci<span class="sc">$</span>data_tag)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-stdout">
<pre><code>[1] "test 1" "test 1" "test 1" "test 1" "test 1" "test 1"</code></pre>
</div>
<p></p><details open="">
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(aci<span class="sc">$</span>data_tag)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-stdout">
<pre><code>[1] "test 2" "test 2" "test 2" "test 2" "test 2" "test 2"</code></pre>
</div>
</div>
<p>也十分方便。</p>
</section>
</section>
<section id="sec-6800-import-python" class="level3" data-number="5.2.3">
<h3 data-number="5.2.3" class="anchored" data-anchor-id="sec-6800-import-python"><span class="header-section-number">5.2.3</span> 使用 Python 来处理</h3>
<p>目前版本的使用非常简单，首先选择 <code>excel</code> 数据文件所在的文件夹，通过点击 <code>Choose the data folder</code> 来实现，然后点击 <code>Run LI-6800 Excel Converter</code> 来运行整个转换过程即可，最后转换的 csv 文件存放于数据文件夹内新生成的一个叫做 <code>final-csv-data</code> 的文件夹内，当前版本无需指定表头所在的行号，直接运行即可。程序很简单，如果不是要整理为图形界面，那么没有几行，已经上传 github：</p>
<p><a href="https://github.com/zhujiedong/LI6800_excel2csv">python 源代码</a></p>
<p>如果不嫌弃图形界面打开需要等待 1 min 左右的时间，那么可以从下面的链接下周 exe 程序双击直接运行即可。</p>
<p><a href="https://www.aliyundrive.com/s/FPcqSoUfYQJ">LI6800_excel2csv</a></p>
</section>
<section id="sec-6800-batch" class="level3" data-number="5.2.4">
<h3 data-number="5.2.4" class="anchored" data-anchor-id="sec-6800-batch"><span class="header-section-number">5.2.4</span> 批量处理 csv 文件</h3>
<p>如果还是比习惯用 <code>R</code>，我们来处理上面的 <code>csv</code> 文件即可 (期望后面添加到软件包里，成为一个函数，<code>r</code>Sys.Date()` 尚未有时间修改)：</p>
<div class="cell">
<p></p><details open="">
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>files_csv <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="st">"./data/csvdata"</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>files_csv</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-stdout">
<pre><code>[1] "./data/csvdata/racirtest1.csv" "./data/csvdata/rcirtest3.csv" </code></pre>
</div>
<p></p><details open="">
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>add_remark <span class="ot">&lt;-</span> <span class="cf">function</span>(path){</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(path)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>remarks <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">".csv"</span>, <span class="st">""</span>, <span class="fu">basename</span>(path))</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>list_csv <span class="ot">&lt;-</span> <span class="fu">lapply</span>(files_csv, add_remark)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>df_remark <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, list_csv)</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(df_remark)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>会在数据的添加 <code>remarks</code>，在最后一列，按照上面的代码，产生的内容是 <code>csv</code> 文件的文件名：</p>
<div class="cell">
<div class="cell-output-display">
<div id="htmlwidget-04f24d7f506b06eef52e" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-04f24d7f506b06eef52e">{"x":{"filter":"none","vertical":false,"caption":"<caption>LI-6800 数据批量导入后添加标注信息{#tbl-6800-add-remark}<\/caption>","data":[["1","2","3","4","5","6"],[1,2,3,4,5,6],[1617082892.5,1617082895,1617082896.5,1617082899,1617082900.5,1617082902.5],[0,2.5,4,6.5,8,10],["20210330 13:41:32","20210330 13:41:35","20210330 13:41:36","20210330 13:41:39","20210330 13:41:40","20210330 13:41:42"],["13:41:32","13:41:35","13:41:36","13:41:39","13:41:40","13:41:42"],[2,2,2,2,2,2],[1617082891.25,1617082893.75,1617082895,1617082897.75,1617082899,1617082901.5],[0.00117700583784644,0.00117867667413708,0.00117958277651496,0.00118133975583066,0.00118240763580541,0.00118302875148573],[1.17700583784643,1.17867667413708,1.17958277651496,1.18133975583067,1.18240763580541,1.18302875148573],[-1.29640512101165,-1.31304378790652,-1.32154230520143,-1.28041999259812,-1.28327869144888,-1.30255845452108],[21.91885,21.9093,21.9132,21.9953,22.196825,23.1002333333333],[43.3618556686005,43.6056775477371,43.7314401788899,43.075743664199,43.2904329806567,44.4562345890393],[4.38617075627391,4.41085866998296,4.42353837045396,4.35714213725565,4.37888234843704,4.49692129905192],[2.21715185844253,2.21619824052643,2.21657189022153,2.22484025345407,2.24523707645235,2.33667858400557],[0.0953075695813409,0.0954287884211052,0.0955220291770267,0.0957200242718292,0.095861653292916,0.0960589745472595],[2.94950248328432,2.94754277570211,2.94769091783939,2.94897784556768,2.94763966108142,2.94757706768172],[0.0936291448563997,0.0937450346770617,0.093835098050862,0.0940268846040971,0.0941627912407548,0.0943531429813632],[0.0586665533096607,0.0587394507300311,0.0587960188915627,0.0589164301741158,0.0590018727781437,0.0591214533775718],[193.811463,193.812261,193.811862,193.813458,193.81266,193.813325000001],[27.6605634515244,27.6617756660851,27.6612252062747,27.6565944131661,27.6552658000399,27.6522604666165],[26.28095,26.28185,26.2807,26.277525,26.2746,26.2661],[3.43076352327159,3.43094585217195,3.43071287785649,3.43006973787993,3.42947733202655,3.42775631779318],[61.9339569056717,61.9284931252363,61.929911257426,61.9455663505962,61.952508664289,61.9652038067068],[2.19453663333942,2.19448821111549,2.19450297412762,2.19456078784681,2.19462603765726,2.19470572015551],[3.5433496307717,3.54358406021222,3.54352675398752,3.54272455178818,3.5424328812084,3.54183571638308],[1.23622688993217,1.23645764105646,1.23620990372887,1.23550895003313,1.23485129436929,1.23305059763767],[-51.9059574490278,-51.9796413294452,-52.0196004443098,-52.0970832321323,-52.1441767390188,-52.1715679405207],[87.1314899987018,87.1093524028331,87.2527819022822,87.1835603835181,87.3863408595812,88.279676934362],[6.34698304945913,6.34965364622582,6.35974363535337,6.35170153750401,6.36922734900457,6.43410941710091],[235.383978599133,235.291625719614,235.404787093326,235.25163668889,235.424051469567,236.355543410943],[-1.30886151510316,-1.32022277860328,-1.27937244729134,-0.742412970041709,-0.192501114961114,1.16883744390688],[1.17821275277723,1.17913396773934,1.17962992433815,1.18165612843244,1.18261434737241,1.18310462394623],[-1.29640512101165,-1.31304378790652,-1.32154230520143,-1.28041999259812,-1.28327869144888,-1.30255845452108],[20.417227897631,20.3817418255343,20.3857620897769,20.9040409645513,21.8503631275701,23.9901691524438],[22.4016557575757,22.3918878787879,22.4078296969697,22.5529896969697,22.9144109090909,23.8886448484848],[-5.18758727162179e-05,-0.000109622813610789,0.000131280015557853,0.0691622596983143,0.200322313027271,0.46628717969177],[66.5001345329119,66.5001345329119,66.5001345329119,66.5001345329119,66.5001345329119,66.5001345329119],[1.17700583784643,1.17867667413708,1.17958277651496,1.18133975583067,1.18240763580541,1.18302875148573],[19.9674802888312,19.9651435619048,19.9643574777489,19.9629398774026,19.9618240263203,19.9606446780952],[21.6949593939394,21.6950175757576,21.6952218181818,21.6964642424242,21.6967569696969,21.6966363636364],[-5.551515151518e-05,-4.55187165778545e-05,1.68843995512668e-05,-2.69131997882549e-06,3.48739002935232e-05,1.79871441692421e-05],[79.88,79.88,79.88,79.88,79.88,79.88],[0,0,0,0,0,0],[0,0,0,0,0,0],[1,1,1,1,1,1],[0,0,0,0,0,0],[53510.6804325952,53453.3925475691,53457.736652952,53495.8905668424,53457.1522376728,53455.8932483073],["-","-","-","-","-","-"],["-","-","-","-","-","-"],[0,0,0,0,0,0],[0,0,0,0,0,0],[null,null,null,null,null,null],[0,0,0,0,0,0],["-","-","-","-","-","-"],["-","-","-","-","-","-"],[0,0,0,0,0,0],[0,0,0,0,0,0],[null,null,null,null,null,null],[0.5,0.5,0.5,0.5,0.5,0.5],[1009.1835,1009.1877,1009.1856,1009.194,1009.1898,1009.1933],[-1.29640512101165,-1.31304378790652,-1.32154230520143,-1.28041999259812,-1.28327869144888,-1.30255845452108],[null,null,null,null,null,null],[-0.0012846079241403,-0.00130108976546833,-0.0013095136367398,-0.00126875505858945,-0.00127159300604196,-0.00129069272905506],[null,null,null,null,null,null],[null,null,null,null,null,null],["-","-","-","-","-","-"],[0,0,0,0,0,0],[null,null,null,null,null,null],[null,null,null,null,null,null],[null,null,null,null,null,null],[null,null,null,null,null,null],[null,null,null,null,null,null],[null,null,null,null,null,null],[null,null,null,null,null,null],[null,null,null,null,null,null],[1199.995,1200,1199.9975,1200.0075,1200.0025,1200.00666666667],[1009.1835,1009.1877,1009.1856,1009.194,1009.1898,1009.1933],[0.840989754123976,0.84098975,0.840989752061983,0.840989743814101,0.840989747938025,0.840989744501419],[0.161510225459273,0.1615102175,0.161510221479628,0.161510205561215,0.161510213520388,0.16151020688774],[9,9,9,9,9,9],[0.5,0.5,0.5,0.5,0.5,0.5],["0: Broadleaf","0: Broadleaf","0: Broadleaf","0: Broadleaf","0: Broadleaf","0: Broadleaf"],[2,2,2,2,2,2],[1,1,1,1,1,1],[1617082891.25,1617082893.75,1617082895,1617082897.75,1617082899,1617082901.5],[21.91885,21.9093,21.9132,21.9953,22.196825,23.1002333333333],[19.994325,19.96775,20.03295,20.9207,21.94745,24.8945333333333],[21.695275,21.694675,21.695025,21.69595,21.696475,21.6967],[19.966325,19.964375,19.964,19.961975,19.96105,19.9605],[17.598275,17.588775,17.592675,17.67475,17.876275,18.7797],[21.717175,21.7166,21.716975,21.7179,21.7184,21.7186333333333],[600.00925,600.01025,600.011,600.0185,600.003,599.983666666667],[101.1055,101.10675,101.10575,101.104,101.1045,101.107],[0.047245625,0.046561175,0.046609775,0.0467119,0.0467717,0.0468953],[26.8289,26.830025,26.82975,26.8259,26.8245,26.8216333333333],[26.28095,26.28185,26.2807,26.277525,26.2746,26.2661],[999.9,999.9,999.9,999.9,999.9,999.9],[0,0,0,0,0,0],[0,0,0,0,0,0],[10003.595,9992.34,9993.28,10000.7625,9993.1125,9992.51],[0,0,0,0,0,0],[45.2903,45.416025,45.474425,45.548625,45.5658,45.6088666666667],[1199.995,1200,1199.9975,1200.0075,1200.0025,1200.00666666667],[0.967009,0.967009,0.967009,0.967009,0.967009,0.967009],[0.0329912,0.0329912,0.0329912,0.0329912,0.0329912,0.0329912],[0,0,0,0,0,0],[2.75025,2.646775,2.729575,2.628825,2.624775,2.59406666666667],[0,0,0,0,0,0],[4008.905,4009.425,4009.8275,4009.78,4009.0675,4006.96666666667],[10372.25,10372.3,10372.275,10372.375,10372.325,10372.3666666667],[40.73425,40.75,40.73425,40.7495,40.7185,40.75],[43.5625,43.531,43.56225,43.5935,43.64025,43.5416666666667],[42.4215,42.406,42.3905,42.406,42.406,42.3956666666667],[41.87475,41.8745,41.87475,41.9685,41.984,41.7913333333333],[40.7965,40.812,40.7965,40.812,40.7965,40.7913333333333],[1160.405,1160.41,1160.4075,1160.4175,1160.4125,1160.41666666667],[39.59,39.59,39.59,39.59,39.59,39.59],[0,0,0,0,0,0],[1617082893,1617082895.4,1617082897.2,1617082899.6,1617082900.8,1617082903.2],[0,0,0,0,0,0],[2.56566538461538,2.57525,2.57696,2.60566,2.623516,2.620524],[0.48102222295631,0.380598285995655,0.738015375232096,0.930661531108041,0.110115375336973,0.0663153785742276],[17.0916239102893,16.9094017165519,16.9769230760005,13.3723077134935,9.38230770466215,-4.9538461660765],[4006.98346153846,4007.66230769231,4008.2364,4008.7392,4008.8796,4008.7472],[15,15,15,15,15,15],[1617082512,1617082512,1617082512,1617082512,1617082512,1617082512],["13:35:12","13:35:12","13:35:12","13:35:12","13:35:12","13:35:12"],[1617082511,1617082511,1617082511,1617082511,1617082511,1617082511],[1617082512,1617082512,1617082512,1617082512,1617082512,1617082512],[2,2,2,2,2,2],[-0.012,-0.012,-0.012,-0.012,-0.012,-0.012],[-0.035,-0.035,-0.035,-0.035,-0.035,-0.035],[4.321,4.321,4.321,4.321,4.321,4.321],[-0.022,-0.022,-0.022,-0.022,-0.022,-0.022],[400,400,400,400,400,400],[20,20,20,20,20,20],[0.13,0.13,0.13,0.13,0.13,0.13],[0.05,0.05,0.05,0.05,0.05,0.05],[100,100,100,100,100,100],[100,100,100,100,100,100],[4.32,4.32,4.321,4.32,4.32,4.32],[-0.0219,-0.0219,-0.0219,-0.0219,-0.0219,-0.0219],[4.32055000000003,4.32055000000003,4.32055000000003,4.32055000000003,4.32055000000003,4.32055000000003],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[-0.0219400000000007,-0.0219400000000007,-0.0219400000000007,-0.0219400000000007,-0.0219400000000007,-0.0219400000000007],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1],[6.4,6.4,6.4,6.5,6.5,6.5],[6.3,6.4,6.4,6.5,6.5,6.5],[18,18,18,18,18,18],[646.822,647.002,646.866,646.672,646.846,646.938],[392.817,392.759,392.795,392.887,392.828,392.756],[24.9992,24.999,24.999,24.9989,24.9988,24.9988],[27.8989,27.8989,27.8989,27.8981,27.8972,27.8965],[30,30,30,30,29.9999,30],[27.9067,27.9056,27.9056,27.9056,27.9056,27.9051],[27.948,27.948,27.9471,27.9457,27.9457,27.9457],[3.98628,4.08099,4.17522,4.38255,4.46969,4.6219],[23.5803,23.5803,23.5803,23.5803,23.5803,23.5803],[47.208,47.208,47.208,47.208,47.208,47.208],[25,25,25,25,25,25],[23.3772,26.7963,26.7963,33.5145,33.5145,36.8578],[20,20,20,20,20,20],[96.8399,96.8405,96.8409,96.8411,96.8413,96.8411],[99.4131,99.4111,99.4112,99.4125,99.4125,99.4118],["racirtest1","racirtest1","racirtest1","racirtest1","racirtest1","racirtest1"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>obs<\/th>\n      <th>time<\/th>\n      <th>elapsed<\/th>\n      <th>date<\/th>\n      <th>hhmmss<\/th>\n      <th>averaging<\/th>\n      <th>TIME<\/th>\n      <th>E<\/th>\n      <th>Emm<\/th>\n      <th>A<\/th>\n      <th>Ca<\/th>\n      <th>Ci<\/th>\n      <th>Pci<\/th>\n      <th>Pca<\/th>\n      <th>gsw<\/th>\n      <th>gbw<\/th>\n      <th>gtw<\/th>\n      <th>gtc<\/th>\n      <th>Rabs<\/th>\n      <th>TleafEB<\/th>\n      <th>TleafCnd<\/th>\n      <th>SVPleaf<\/th>\n      <th>RHcham<\/th>\n      <th>VPcham<\/th>\n      <th>SVPcham<\/th>\n      <th>VPDleaf<\/th>\n      <th>LatHFlux<\/th>\n      <th>SenHFlux<\/th>\n      <th>NetTherm<\/th>\n      <th>EBSum<\/th>\n      <th>Asty<\/th>\n      <th>Esty<\/th>\n      <th>Adyn<\/th>\n      <th>Crd<\/th>\n      <th>Csd<\/th>\n      <th>dCsd.dt<\/th>\n      <th>伪Vc<\/th>\n      <th>Edyn<\/th>\n      <th>Hr<\/th>\n      <th>Hs<\/th>\n      <th>dHs.dt<\/th>\n      <th>伪Vh<\/th>\n      <th>Leak<\/th>\n      <th>LeakPct<\/th>\n      <th>CorrFact<\/th>\n      <th>CorrFactPct<\/th>\n      <th>Fan<\/th>\n      <th>DarkAdaptedID<\/th>\n      <th>Qmax_d<\/th>\n      <th>Fo<\/th>\n      <th>Fm<\/th>\n      <th>Fv.Fm<\/th>\n      <th>A_dark<\/th>\n      <th>LightAdaptedID<\/th>\n      <th>Qmax<\/th>\n      <th>Fs<\/th>\n      <th>Fm.<\/th>\n      <th>PhiPS2<\/th>\n      <th>PS2.1<\/th>\n      <th>Qabs_fs<\/th>\n      <th>A_fs<\/th>\n      <th>ETR<\/th>\n      <th>PhiCO2<\/th>\n      <th>NPQ<\/th>\n      <th>alt..Fo.<\/th>\n      <th>DarkPulseID<\/th>\n      <th>Fmin<\/th>\n      <th>Fo.<\/th>\n      <th>Fv..Fm.<\/th>\n      <th>qP<\/th>\n      <th>qN<\/th>\n      <th>qP_Fo<\/th>\n      <th>qN_Fo<\/th>\n      <th>qL<\/th>\n      <th>X1.qL<\/th>\n      <th>Qin<\/th>\n      <th>Qabs<\/th>\n      <th>alpha<\/th>\n      <th>convert<\/th>\n      <th>S<\/th>\n      <th>K<\/th>\n      <th>Geometry<\/th>\n      <th>Custom<\/th>\n      <th>UseDynamic<\/th>\n      <th>TIME.1<\/th>\n      <th>CO2_s<\/th>\n      <th>CO2_r<\/th>\n      <th>H2O_s<\/th>\n      <th>H2O_r<\/th>\n      <th>CO2_a<\/th>\n      <th>H2O_a<\/th>\n      <th>Flow<\/th>\n      <th>Pa<\/th>\n      <th>螖Pcham<\/th>\n      <th>Tair<\/th>\n      <th>Tleaf<\/th>\n      <th>Tleaf2<\/th>\n      <th>Offset<\/th>\n      <th>Offset2<\/th>\n      <th>Fan_speed<\/th>\n      <th>Qamb_in<\/th>\n      <th>Qamb_out<\/th>\n      <th>Q<\/th>\n      <th>f_red<\/th>\n      <th>f_blue<\/th>\n      <th>f_farred<\/th>\n      <th>F<\/th>\n      <th>Q_modavg<\/th>\n      <th>F_dc<\/th>\n      <th>Pc<\/th>\n      <th>Tled<\/th>\n      <th>TDigital<\/th>\n      <th>TPreamp<\/th>\n      <th>TPwrSpy<\/th>\n      <th>TDrive<\/th>\n      <th>Q_red<\/th>\n      <th>Q_blue<\/th>\n      <th>Q_farred<\/th>\n      <th>TSPF<\/th>\n      <th>state<\/th>\n      <th>F_avg<\/th>\n      <th>dF.dt<\/th>\n      <th>dF_dc.dt<\/th>\n      <th>F_dc_avg<\/th>\n      <th>period<\/th>\n      <th>time.1<\/th>\n      <th>hhmmss.1<\/th>\n      <th>co2_t<\/th>\n      <th>h2o_t<\/th>\n      <th>count<\/th>\n      <th>co2_adj<\/th>\n      <th>h2o_adj<\/th>\n      <th>co2_match<\/th>\n      <th>h2o_match<\/th>\n      <th>co2_at<\/th>\n      <th>h2o_at<\/th>\n      <th>co2_cv<\/th>\n      <th>h2o_cv<\/th>\n      <th>MatchValveR<\/th>\n      <th>MatchValveS<\/th>\n      <th>MatchCO2<\/th>\n      <th>MatchH2O<\/th>\n      <th>cf_co2_a<\/th>\n      <th>cf_co2_b<\/th>\n      <th>cf_co2_c<\/th>\n      <th>cf_co2_d<\/th>\n      <th>cf_h2o_a<\/th>\n      <th>cf_h2o_b<\/th>\n      <th>cf_h2o_c<\/th>\n      <th>cf_h2o_d<\/th>\n      <th>co2_fit_low<\/th>\n      <th>co2_fit_high<\/th>\n      <th>h2o_fit_low<\/th>\n      <th>h2o_fit_high<\/th>\n      <th>co2_elapsed<\/th>\n      <th>h2o_elapsed<\/th>\n      <th>DIAG<\/th>\n      <th>Flow_s<\/th>\n      <th>Flow_r<\/th>\n      <th>Txchg<\/th>\n      <th>Tirga<\/th>\n      <th>Tchopper<\/th>\n      <th>Ts<\/th>\n      <th>Tr<\/th>\n      <th>CO2_.<\/th>\n      <th>Desiccant_.<\/th>\n      <th>Humidifier_.<\/th>\n      <th>Txchg_sp<\/th>\n      <th>CO2_r_sp<\/th>\n      <th>H2O_r_sp<\/th>\n      <th>SS_s<\/th>\n      <th>SS_r<\/th>\n      <th>remarks<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,50,51,53,56,57,59,60,61,63,67,76,77,78,79,80,81,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>到此为止已经整理为所谓的 <code>tidy data</code> 了，用 <code>tidyverse</code> 也好，用 <code>base</code> 语法也好，总之是比较容易处理的数据了，例如上面其实是 <code>RACiR</code> 数据了，有两个，那么当然可以使用 <code>plantecophys::fitacis</code> 来一条命令搞定所有数据的拟合了。</p>
<p>这里需要注意的是使用 <code>xlconnect_read</code> 也可以使用类似的操作，但我觉得不如这种方法省事，故而只列出来这一种，有需要的也可以按照类似方法处理即可。</p>


</section>
</section>
</main> <!-- /main -->
<script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    setTimeout(function() {
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./data-prepare.html">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">数据准备</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./batch-method.html">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">数据的基本处理</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->


</body></html>